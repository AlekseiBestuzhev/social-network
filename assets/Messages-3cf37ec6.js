import{r as i,D as u,j as e,m as d,V as x,W as f,X as N,Y as v,Z as w,_ as D,N as L,l as k,A as M,k as C,T as I,$ as S}from"./index-7ab9cb1f.js";import{w as W}from"./withAuthRedirect-d68edd03.js";import{A as $}from"./AddItemForm-891a0a63.js";const R=""+new URL("messages-49b20e1c.gif",import.meta.url).href,T=""+new URL("messages-5daa85f7.webp",import.meta.url).href,b="_wrapper_3g3eu_1",A="_header_3g3eu_6",z="_name_3g3eu_14",y="_menuIcon_3g3eu_18",P="_formWrapper_3g3eu_28",l={wrapper:b,header:A,name:z,menuIcon:y,formWrapper:P},E=""+new URL("dialog-a2d86ade.gif",import.meta.url).href,q=""+new URL("dialog-dde93bae.webp",import.meta.url).href,B="_dialogMessages_g230i_1",U={dialogMessages:B},F="_wrapper_5uton_1",V="_message_5uton_7",X="_time_5uton_26",Y="_iSender_5uton_31",m={wrapper:F,message:V,time:X,iSender:Y},Z=i.memo(({text:s,iSender:a,time:o})=>{const t=u(m.wrapper,{[m.iSender]:a});return e.jsxs("div",{className:t,children:[e.jsx("div",{className:m.message,children:s}),e.jsx("p",{className:m.time,children:o})]})}),h=s=>s.messagesPage.messagesData,G=i.memo(({userID:s})=>{const a=i.useRef(null),o=d(h)[s],t=()=>{var n;(n=a.current)==null||n.scrollIntoView({behavior:"smooth"})};i.useEffect(()=>{t()},[o]);const r=o.length?o.map(n=>e.jsx(Z,{id:n.id,text:n.text,userID:n.userID,userName:n.userName,avatar:n.avatar,time:n.time,date:n.date,iSender:s!==n.userID},n.id)):e.jsx(x,{text:"Write a message to start chatting...",picture:E,pictureWebp:q});return e.jsxs("div",{className:U.dialogMessages,children:[r,e.jsx("div",{ref:a})]})}),H=s=>({currentText:s.messagesPage.newMessageText}),J=s=>({updateCurrentText:a=>{const o=v(a);s(o)},addText:(a,o,t)=>{const r=N(a,o,t);s(r)}}),K=f(H,J)($),j=s=>s.messagesPage.dialogsData,O=i.memo(({userID:s})=>{const a=d(j),o=(()=>{const t=a.find(r=>r.id===s);return(t==null?void 0:t.name)||""})();return e.jsxs("div",{className:l.wrapper,children:[e.jsxs("div",{className:l.header,children:[e.jsx("h4",{className:l.name,children:o}),e.jsx(w,{className:l.menuIcon,onClick:()=>alert("There will be a drop-down list")})]}),e.jsx(G,{userID:s}),e.jsx("div",{className:l.formWrapper,children:e.jsxs(K,{placeholder:"Enter a message...",children:["Send ",e.jsx(D,{})]})})]})}),Q="_dialog_1eurz_1",ee="_link_1eurz_9",se="_textBlock_1eurz_17",ae="_topLine_1eurz_20",te="_name_1eurz_24",ne="_lastMessage_1eurz_28",oe="_activeLink_1eurz_34",c={dialog:Q,link:ee,textBlock:se,topLine:ae,name:te,lastMessage:ne,activeLink:oe},re=i.memo(({id:s,name:a,avatar:o,lastMessage:t,lastDate:r})=>{const n=({isActive:p})=>u(c.link,{[c.activeLink]:p});return e.jsx("li",{className:c.dialog,children:e.jsxs(L,{to:`${k.messages}/${s}`,className:n,children:[e.jsx(M,{photo:o,size:"3.5rem"}),e.jsxs("div",{className:c.textBlock,children:[e.jsxs("div",{className:c.topLine,children:[e.jsx("p",{className:c.name,children:a}),e.jsx("p",{className:c.date,children:r.slice(0,-5)})]}),e.jsx("p",{className:c.lastMessage,children:t})]})]})})}),ce="_dialogItems_m4u6p_1",ie="_emptyList_m4u6p_6",_={dialogItems:ce,emptyList:ie},le=()=>{const s=d(j),a=d(h),o=s.length?s.map(t=>{const r=a[t.id][a[t.id].length-1],n=(r==null?void 0:r.text)||"",p=(r==null?void 0:r.date)||"";return e.jsx(re,{id:t.id,name:t.name,avatar:t.avatar,lastMessage:n,lastDate:p},t.id)}):e.jsx("span",{className:_.emptyList,children:"Nobody needs you..."});return e.jsx("ul",{className:_.dialogItems,children:o})},me="_page_1qx8j_1",de="_leftColumn_1qx8j_6",pe="_title_1qx8j_9",ge="_rightColumn_1qx8j_17",_e="_formWrapper_1qx8j_22",g={page:me,leftColumn:de,title:pe,rightColumn:ge,formWrapper:_e},je=W(()=>{const s=C(),{userID:a}=I();return i.useEffect(()=>{s(S(a||""))},[a]),e.jsxs("div",{className:g.page,children:[e.jsxs("div",{className:g.leftColumn,children:[e.jsx("h2",{className:g.title,children:"Dialogs"}),e.jsx(le,{})]}),a?e.jsx(O,{userID:a}):e.jsx(x,{text:"Choose the dialog...",picture:R,pictureWebp:T,size:"16rem"})]})});export{je as Messages};
